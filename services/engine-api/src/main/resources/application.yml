spring:
  application:
    name: engine-api
  config:
    # Load dotenv-style config for local dev regardless of how the app is started:
    # - IntelliJ "Application" run config (often runs from repo root)
    # - Gradle bootRun (often runs from service dir)
    import: "optional:file:./.env[.properties],optional:file:./services/engine-api/.env[.properties]"
  security:
    oauth2:
      resourceserver:
        jwt:
          # Allow running from IntelliJ even when SUPABASE_JWKS_URL isn't explicitly set.
          # Falls back to the standard Supabase JWKS endpoint derived from SUPABASE_URL.
          jwk-set-uri: ${SUPABASE_JWKS_URL:${SUPABASE_URL}/auth/v1/.well-known/jwks.json}

server:
  port: ${PORT:8080}

management:
  endpoints:
    web:
      exposure:
        include: health,info

logging:
  level:
    root: INFO

app:
  supabase:
    url: ${SUPABASE_URL:}
    service-role-key: ${SUPABASE_SERVICE_ROLE_KEY:}
    max-retries: ${SUPABASE_MAX_RETRIES:2}
    retry-backoff-ms: ${SUPABASE_RETRY_BACKOFF_MS:300}
    request-timeout-ms: ${SUPABASE_REQUEST_TIMEOUT_MS:5000}
  gemini:
    api-key: ${GEMINI_API_KEY:}
    model: ${GEMINI_MODEL:gemini-2.5-flash}
    api-base-url: ${GEMINI_API_BASE_URL:https://generativelanguage.googleapis.com}
    request-timeout-ms: ${GEMINI_REQUEST_TIMEOUT_MS:15000}
